<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Date Checker</title>
</head>
<body>
<button id="checkDateBtn">Check Date</button>
<p id="result"></p>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script>
const supabaseUrl = 'https://tdsxayxnjomnoiestnmj.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRkc3hheXhuam9tbm9pZXN0bm1qIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTE3NDg4NzUsImV4cCI6MjAyNzMyNDg3NX0._1GPeVJvMjrSyNX3x2mDSGACVIdFkmlD96rgDfOzSkY';

// Initialize Supabase client
const supabase = window.Supabase.createClient(supabaseUrl, supabaseKey);

document.getElementById("checkDateBtn").addEventListener("click", async function() {
    // Get user email from local storage
    const userEmail = localStorage.getItem('email');
    if (!userEmail) {
        alert('Email not found in local storage');
        return;
    }

    try {
        // Fetch user from auth table
        const { data: user, error } = await supabase
            .from('auth.users')
            .select('created_at')
            .eq('email', userEmail)
            .single();

        if (error || !user) {
            alert('User not found');
            return;
        }

        // Calculate difference in months between current date and user creation date
        const creationDate = new Date(user.created_at);
        const currentDate = new Date();
        const diffMonths = (currentDate.getFullYear() - creationDate.getFullYear()) * 12 + currentDate.getMonth() - creationDate.getMonth();

        // Display result
        const resultElement = document.getElementById('result');
        if (diffMonths >= 2) {
            resultElement.textContent = 'Yay! Your account is 2 months or older.';
        } else {
            resultElement.textContent = 'Your account is less than 2 months old.';
        }
    } catch (error) {
        console.error('Error:', error.message);
    }
});
</script>

</body>
</html>
